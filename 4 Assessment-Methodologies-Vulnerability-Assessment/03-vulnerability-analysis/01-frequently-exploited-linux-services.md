# Frequently Exploited Linux Services

## Linux Overview and Architecture

### What is Linux?

Linux is a free and open-source operating system composed of:

- **Linux Kernel**: Core operating system component developed by Linus Torvalds
- **GNU Toolkit**: Collection of software utilities developed by Richard Stallman
- **Combined**: Forms GNU/Linux, the complete operating system

### Common GNU Tools

```bash
# Essential GNU utilities
ls, cat, cd, mkdir, rm, cp, mv, grep, find, tar, gzip
```

### Linux Distributions (Distros)

- **Kali Linux**: Penetration testing and security research
- **Ubuntu**: General-purpose desktop and server
- **Debian**: Stable, community-driven distribution
- **CentOS/RHEL**: Enterprise server environments
- **Arch Linux**: Rolling release, DIY approach

## Core Linux Services and Attack Vectors

### 1. Apache HTTP Server

**Default Ports:** TCP 80 (HTTP), 443 (HTTPS)

**Purpose:**

- Free, open-source cross-platform web server
- Powers over 80% of web servers globally
- Hosts websites and web applications

**Common Attack Vectors:**

```bash
# Version detection
nmap -sV -p 80,443 <target_ip>

# Common vulnerabilities
- ShellShock (CVE-2014-6271)
- Mod_ssl buffer overflow (CVE-2002-0082)
- Directory traversal
- Server-side request forgery (SSRF)
```

### 2. SSH (Secure Shell)

**Default Port:** TCP 22

**Purpose:**

- Cryptographic remote access protocol
- Secure replacement for Telnet
- Supports password and key-based authentication

**Common Attack Vectors:**

```bash
# Service detection
nmap -sV -p 22 <target_ip>

# Common vulnerabilities
- Weak credentials (brute force)
- SSH protocol vulnerabilities
- Private key exposure
- Configuration weaknesses
```

**Brute-Force Example:**

```bash
# Hydra SSH brute force
hydra -L users.txt -P passwords.txt ssh://<target_ip>

# Metasploit module
use auxiliary/scanner/ssh/ssh_login
set RHOSTS <target_ip>
set USER_FILE users.txt
set PASS_FILE passwords.txt
run
```

### 3. FTP (File Transfer Protocol)

**Default Port:** TCP 21

**Purpose:**

- File sharing between server and clients
- Often paired with web servers for file uploads
- Supports anonymous and authenticated access

**Common Attack Vectors:**

```bash
# Service detection
nmap -sV -p 21 <target_ip>

# Common vulnerabilities
- Anonymous access with write permissions
- Weak credentials
- FTP bounce attacks
- Plain text credential transmission
```

**Exploitation Examples:**

```bash
# Anonymous access test
ftp <target_ip>
Username: anonymous
Password: (any email or blank)

# Brute force with Hydra
hydra -L users.txt -P passwords.txt ftp://<target_ip>
```

### 4. Samba (SMB/CIFS Implementation)

**Default Port:** TCP 445, 139

**Purpose:**

- Open-source Linux implementation of SMB/CIFS
- Enables file and printer sharing with Windows systems
- Provides domain controller functionality

**Common Attack Vectors:**

```bash
# Service detection
nmap -sV -p 445,139 <target_ip>

# Common vulnerabilities
- SambaCry (CVE-2017-7494)
- EternalBlue variants
- Weak share permissions
- Information disclosure
```

**Enumeration Commands:**

```bash
# Share enumeration
smbclient -L //<target_ip>/ -N

# Samba version detection
nmap -p 445 --script smb-os-discovery <target_ip>

# Vulnerability scanning
nmap -p 445 --script smb-vuln* <target_ip>
```

## Additional Critical Services

### 5. MySQL/MariaDB

**Default Port:** TCP 3306

**Purpose:**

- Relational database management systems
- Backend for web applications
- Common in LAMP/LEMP stacks

**Attack Vectors:**

```bash
# Default credential testing
mysql -h <target_ip> -u root -p

# Brute force
hydra -L users.txt -P passwords.txt mysql://<target_ip>
```

### 6. NFS (Network File System)

**Default Port:** TCP 2049

**Purpose:**

- Distributed file system protocol
- File sharing between Unix/Linux systems

**Attack Vectors:**

```bash
# Share enumeration
showmount -e <target_ip>

# Common vulnerabilities
- World-readable/writable exports
- Root squashing misconfigurations
```

### 7. RPC (Remote Procedure Call)

**Default Port:** TCP 111

**Purpose:**

- Inter-process communication
- Used by NFS and other services

**Attack Vectors:**

```bash
# RPC service enumeration
rpcinfo -p <target_ip>
```

## Service Discovery Methodology

### Comprehensive Scanning

```bash
# Basic service scan
nmap -sS -sV -O <target_ip>

# Focused Linux service scan
nmap -sS -sV -p 21,22,80,443,445,3306,2049,111 <target_ip>

# Script scanning for vulnerabilities
nmap --script vuln <target_ip>
```

### Service-Specific Enumeration Script

```bash
#!/bin/bash
# linux_service_scan.sh
TARGET=$1

echo "[*] Scanning Linux services on $TARGET"

# Web services
nmap -p 80,443,8080 --script http-enum,http-vuln* $TARGET

# SSH
nmap -p 22 --script ssh-auth-methods,ssh2-enum-algos $TARGET

# SMB/Samba
nmap -p 445,139 --script smb-enum-shares,smb-vuln* $TARGET

# FTP
nmap -p 21 --script ftp-anon,ftp-bounce $TARGET

echo "[*] Scan complete"
```

## Defense and Hardening

### Service Hardening Recommendations

**SSH Security:**

```bash
# Disable root login
echo "PermitRootLogin no" >> /etc/ssh/sshd_config

# Use key-based authentication
echo "PasswordAuthentication no" >> /etc/ssh/sshd_config

# Change default port
echo "Port 2222" >> /etc/ssh/sshd_config
```

**Apache Security:**

```bash
# Hide server version
echo "ServerTokens Prod" >> /etc/apache2/apache2.conf
echo "ServerSignature Off" >> /etc/apache2/apache2.conf

# Disable directory listing
echo "Options -Indexes" >> /etc/apache2/apache2.conf
```

**Samba Security:**

```bash
# Disable SMBv1 if not needed
echo "client min protocol = SMB2" >> /etc/samba/smb.conf
echo "server min protocol = SMB2" >> /etc/samba/smb.conf
```

## Real-World Attack Scenarios

### Common Attack Chains

**Web Server Compromise:**

```
Apache Vulnerability → Web Shell Upload → Reverse Shell → Privilege Escalation
```

**SSH Credential Attack:**

```
Weak SSH Credentials → Initial Access → Lateral Movement → Data Exfiltration
```

**Samba Exploitation:**

```
Samba Vulnerability → Remote Code Execution → Domain Compromise
```

## Practice Environments

### Free Lab Resources

- **TryHackMe Linux Rooms**:
  - [Linux Fundamentals](https://tryhackme.com/module/linux-fundamentals)
  - [Common Linux Privesc](https://tryhackme.com/room/commonlinuxprivesc)
- **Hack The Box**:
  - Various Linux machines with different service configurations
- **VulnHub**:
  - Intentionally vulnerable Linux VMs

### Essential Testing Tools

```bash
# Service-specific tools
enum4linux    # SMB enumeration
smbmap        # SMB share mapping
ssh-audit     # SSH configuration auditing
nikto         # Web server scanning
```

## Key Takeaways

1. **Apache is ubiquitous** - Master web server exploitation techniques
2. **SSH is critical** - Focus on credential attacks and configuration weaknesses
3. **Samba bridges ecosystems** - Understand Windows-Linux integration points
4. **FTP remains prevalent** - Often misconfigured with weak authentication
5. **Database services** - Common in web application architectures
6. **Network services** - NFS and RPC provide additional attack surface

This foundation in Linux service exploitation provides the basis for comprehensive penetration testing against Linux environments, from initial reconnaissance to post-exploitation activities.
